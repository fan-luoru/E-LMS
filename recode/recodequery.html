<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>学习记录查询</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" href="../lib/layui-v2.6.3/css/layui.css" media="all">
		<link rel="stylesheet" href="../css/layuimini.css" media="all">
	</head>
	<body>
	<div>
		<div>
			<fieldset class="table-search-fieldset">
				<legend>搜索学习记录</legend>
				<div style="margin: 10px 10px 10px 10px">
					<form class="layui-form layui-form-pane" action="">
						<div class="layui-form-item">
							
							<div class="layui-inline">
								<label class="layui-form-label">学生姓名</label>
								<div class="layui-input-inline">
									<input type="text" name="studentname" placeholder="请输入学生姓名" autocomplete="off" class="layui-input">
								</div>
							</div>

							<div class="layui-inline">
								<label class="layui-form-label">课程名称</label>
								<div class="layui-input-inline">
									<input type="text" name="coursename" placeholder="请输入姓名" autocomplete="off" class="layui-input">
								</div>
							</div>
								
							<div class="layui-inline">
								<label class="layui-form-label">授课教师</label>
								<div class="layui-input-inline">
									<input type="text" name="teacher" placeholder="请输入姓名" autocomplete="off" class="layui-input">
								</div>
							</div>

							<div class="layui-inline">
								<button type="submit" class="layui-btn layui-btn-primary"  lay-submit lay-filter="data-search-btn"><i class="layui-icon"></i> 搜 索</button>
							</div>
						</div>
					</form>
				</div>
			</fieldset>
		
			<script type="text/html" id="recodeTableToolbar">
				<div class="layui-btn-container">
					<!-- 这里的lay-event="add"和delete在后面的JS代码中要用 -->
					<button class="layui-btn layui-btn-normal layui-btn-sm data-add-btn" lay-event="add"> 添加学习记录 </button>
					<button class="layui-btn layui-btn-sm layui-btn-danger data-delete-btn" lay-event="delete"> 批量删除 </button>
				</div>
			</script>
			<table class="layui-hide" id="recodeTable" lay-filter="recodeTableFilter"></table>
			<script type="text/html" id="recodeTableOperation">
				<a class="layui-btn layui-btn-normal layui-btn-xs data-count-edit" lay-event="detail">查看详情</a>
				<a class="layui-btn  layui-btn-xs data-count-edit" lay-event="edit">修改</a>
				<a class="layui-btn layui-btn-xs layui-btn-danger data-count-delete" lay-event="delete">删除</a>
			</script>
		</div>
	</div>
	<script src="../lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
	
	<script>
		layui.use(['form', 'table'], function () {
			var $ = layui.jquery;     // 获得jQuery
				form = layui.form;    // 获得表单模块
				table = layui.table;
				
			table.render({
				elem: '#recodeTable', // 上面表格的id
				url: './recode.json', // 表格数据JSON文件的位置
				toolbar: '#recodeTableToolbar', // 工具栏的id，上面定义的 ；不写的话工具栏不会出现
				defaultToolbar: ['filter', 'exports', 'print', {
					title: '提示',
					layEvent: 'LAYTABLE_TIPS',
					icon: 'layui-icon-tips'
				}],
				cols: [[ // 列定义
					{type: "checkbox", width: 50},
					{field: 'studentname', width: 180, title: '学生姓名'},
					{field: 'coursename', width: 180, title: '课程名称'},
					{field: 'teacher', width:150, title: '授课教师'},
					{field: 'studytime', title: '学习时长', width: 150},
					{field: 'remark', width: 180, title: '备注'},
					{title: '操作', minWidth: 130, toolbar: '#recodeTableOperation', align: "center"}
				]],
				limits: [10, 15, 20, 25, 50, 100], // 每页显示条数切换
				limit: 20, // 每页默认显示15条数据
				page: true, // 不写的话，分页显示不会显示
				skin: 'line' // 表格有边框
			});
			
			form.on('submit(data-search-btn)', function (data) {
				var result = JSON.stringify(data.field);
				layer.alert(result, {
					title: '最终的搜索信息'
				});
			
				//执行搜索重载
				table.reload('recodeTable', {
					page: {
						curr: 1
					}
					, where: {
						searchParams: result
					}
				}, 'data');
			
				return false;
			});
			
			form.on('switch(modifystatus)', function(obj){
				console.log(obj);
				var param = obj.value;
			});
			
			table.on('toolbar(recodeTableFilter)', function (obj) {
			    if (obj.event === 'add') {  // 监听添加操作，工具栏上的添加用户， lay-event="add"
					var index = layer.open({
						title: '学习记录添加',
						type: 2,
						shade: 0.2,
						maxmin:true,
						shadeClose: true,
						area: ['100%', '100%'],
						content: '../recode/recodeaddition.html',
					});
					$(window).on("resize", function () {
						layer.full(index);
					});
				} else if (obj.event === 'delete') {  // 监听批量删除操作
					var checkStatus = table.checkStatus('recodeTable')
							, data = checkStatus.data;
					layer.alert(JSON.stringify(data));
				}
			});
			
			table.on('checkbox(recodeTableFilter)', function (obj) {
				console.log(obj); // 这里是简单的将信息输出，可看浏览器控制台
			});
				
		});
	</script>
	</body>
</html>